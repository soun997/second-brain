

## 인덱스에 컬럼 추가하기

테이블 액세스를 했지만 필터 조건에 의해 버려지는 레코드들이 많을 경우,
이러한 테이블 액세스 자체가 비효율이다.

인덱스에 컬럼을 추가하는 것은 이런 비효율을 개선할 수 있는 가장 일반적인 방법이다.

### 예시

>`EMP`테이블에서 `DEPTNO=30`이고 `sal >= 2000`인 사원을 찾는 쿼리

##### 인덱스를 `DEPTNO` + `JOB`으로 구성하였을 경우

![[Pasted image 20231126215901.png|500]]

위의 사진과 같이 만족하는 사원은 단 한 명이지만, 이를 찾기 위해 테이블을 여섯 번 액세스 하였다.

이를 해결하기 위해 기존 인덱스에 `SAL`컬럼을 추가하겠다.

##### 인덱스를 `SAL` 컬럼을 추가했을 경우

![[Pasted image 20231126215911.png|500]]

인덱스 스캔량은 줄지 않지만, 테이블 랜덤 액세스 횟수가 1회로 줄어들었다.


### 어떤 컬럼을 추가하는 것이 좋을까?

불필요한 테이블 액세스를 줄이는 컬럼을 추가하는 것이 좋다.

또한, [[인덱스 검색 효율]]을 생각했을 때, 클러스터링 팩터가 좋은 인덱스를 이용하면,
테이블 액세스량에 비해 블록 I/O가 훨씬 적게 발생한다.

그러므로 위의 두 가지를 고려하여 인덱스에 컬럼을 추가하는 것이 좋다.


### 인덱스만 읽고 처리하기

테이블 액세스가 아무리 많아도 필터 조건에 의해 버려지는 레코드가 거의 없는 경우,
모두 다 의미있는 테이블 액세스이므로 이를 최소화하기 힘들다.

인덱스 스캔 과정에서 얻은 데이터가 많다면, 그만큼 테이블 랜덤 액세스가 발생하므로 성능이 느릴 수 밖에 없다. 절대 일량이 많기 때문이다.

그렇기 떄문에  아예 테이블 액세스를 하지 않도록 인덱스에 컬럼을 추가하여 성능을 획기적으로 개선할 수 있다.

이 방법은 효과가 매우 좋지만, 추가해야할 컬럼이 많아 현실적으로 적용하기 곤란한 경우가 많다.

